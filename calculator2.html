
<!-- https://stackoverflow.com/questions/4712585/calculating-future-value-with-compound-interest-with-javascript -->
<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Tribune 401k calculator</title>
	<link rel="preconnect" href="https://fonts.gstatic.com">
	<link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/chartist.js/latest/chartist.min.css">
	

	<style>
		body,input{background-color:#666666; font-family: 'Anton', sans-serif; letter-spacing: 1px;}
		main {margin: 0 auto;}
		/*main,label,input .ct-label{font-family: 'Anton', sans-serif; letter-spacing: 1px; }*/
		main, label{color:#00ff00;}
		input{text-align: right; background-color:white;}
		*, *:before, *:after {
		  box-sizing: border-box;
		  -ms-box-sizing:border-box;
		  -moz-box-sizing:border-box;
		  -webkit-box-sizing:border-box;
		}
		input:focus{border: 1px solid #00ff00; outline: none !important;}
		div.basic, input[type=text] {
			width: 47%;
			text-align: center;
		}
		input[type=text] {
		  font-size:1em;
		  padding: 2px;
		  margin: 4px 0;
		  border-radius: 8px;
		}
		#button{
			height: 50px;
			color:#FFFFFF;
			font-size:1em;
			border-radius: 8px;
			width:99%;
			float:left;
			margin: 2.3% auto;
			border: 1px solid #FFFFFF;
			background-color:#666666;
		}
		#button_text{text-align: center; padding: 10px 0px;}
		#button:hover{
			border: 2px solid #00ff00;
			color: #00ff00;
		}
		div.basic{
			display: inline-block;    
			float: right;
			/*border: .5px solid white;*/
			height: 24px;
			margin: 0px 9px 0px 0px;
    	}
    	div.label{ margin: 3% 0% 1% 0%;}

		.difference, #difference{
			color:#ff8500;
		}
		input#no_match_final, input#with_match_final{color:black;}

		.flexbox {
	        display: flex; 
    	}
    	.pair {flex: 1 1 auto; }

		label{display:inline-block; width:50%;}

		main h2{letter-spacing: 2px;
				text-align: center;
		}

		#line-chart{height:300px; margin: auto;}
		.ct-series-a .ct-line, .ct-series-a .ct-point {stroke:#00ff00;}
		.ct-label {font-size: 15px; color:white;}

		@media (min-width: 700px){
			main{
				max-width: 600px;
			}
			#line-chart{width:45%;}
		}
		@media (min-width: 321px) and (max-width: 699px){
			main h2{font-size: 1.25em; text-align: left;}
			#line-chart{width:100%;}
		}
		@media (max-width: 320px){
			main h2{font-size: 1em; text-align: left;}
			#line-chart{width:100%;}
		}

		button.info{border-radius:10px; outline:none; }
		/*button:active { border-style: outset;}*/

		input #percent{color:orange;}

	</style>


</head>
<body>
	
    <main>
        <h2>Tribune/Alden 401k calculator <button class="info" id="zero" class="tooltip">i</button></h2>
<!--         Enter your salary and how much you contribute each year to find out how much you'll lose with Tribune's
 proposed changes to the the 401(k)	plan -->

		<form>        
        <label for="salary">Salary in dollars <button class="info" id="one" class="tooltip">i</button></label>
        <input type="text" id="salary" value="$60,000"><br/>

        <label for="percent">Your percent contribution <button class="info" id="two" class="tooltip">i</button></label>
        <input type="text" id="percent" value="5%"><br/>
        
        <label for="rate">Rate of return  <button class="info" id="three" class="tooltip">i</button></label>
        <input type="text" id="rate" value="6.5%"><br/>
        
        <label for="years">Years until retirement <button class="info" id="four" class="tooltip">i</button></label>
        <input type="text" id="years" value="4"><br/>
        </form>  
        <!-- <input type="button" id="calculate" value="Click to see your future investment"><br/> -->
        <div id="button"><div id="button_text">Click to see your projected 401(k)</div></div>

        <label id="label_annual_contrib"></label>
        <div id="annual_contrib" class="basic"></div>
        
        <label id="label_annual_company_match"></label>
        <div id="annual_company_match" class="basic"></div>
        
        <div class="flexbox label">
        <div class="pair" id="including_interest"></div>
        <div class="pair">&nbsp;&nbsp;&nbsp;&nbsp;</div>
        <div class="pair">&nbsp;&nbsp;&nbsp;&nbsp;</div>
        <div class="pair" id="label_with_match"></div> 
        <div class="pair" id="label_no_match"></div>
    	</div>

        <div class="flexbox">
        <label class="pair" id="first_year"></label>        
        <div class="pair" id="with_match"></div>
        <div class="pair" id="no_match"></div>
    	</div>

    	<div class="flexbox">
        <label class="pair" id="label_match_final"></label>
        <div class="pair" id="with_match_final"></div>
        <div class="pair" id="no_match_final"></div>
    	</div>

    	<div class="flexbox">
    	<div class="pair">&nbsp;</div>
    	<div class="pair">&nbsp;</div>
    	<div class="pair">&nbsp;</div>
    	<div class="pair">&nbsp;</div>
    	<div class="pair" id="leftarrow"></div>
    	<div class="pair" id="rightarrow"></div>
    	</div>
        <label id="label_difference" class="difference" for="difference"></label>
        <div class="basic" class="difference" id="difference"></div>
    </main>
    	<div id="line-chart" style=""></div>
</body>
<script>


var $ = function(id) {
    return document.getElementById(id);
};

var companyContrib = function(salary, percent){

	var salary = $("salary").value.replace("$","").replace(",","");
    var percent = $("percent").value.replace("%","");
	var contrib = 0;

	if (percent == 0){
		contrib == 0;
		no_match == 0;
		$("annual_contrib").innerHTML = 0;
		$("annual_company_match").innerHTML = 0;
		

	} else if (percent <= 2 && percent > 0) {
		tribune = (salary * (percent / 100))
		employee = (salary * (percent / 100))
		contrib = tribune + employee
		$("annual_contrib").innerHTML = '$'.concat(employee.toLocaleString());
		$("annual_company_match").innerHTML = '$'.concat(tribune.toLocaleString());

	} else if (percent <= 4 && percent > 2){
		tribune = (salary * (2 / 100)) + ((salary * ((percent - 2)  / 100)) / 2 ) 	
		employee = (salary * (percent / 100)) 
		contrib = tribune + employee
		$("annual_contrib").innerHTML = '$'.concat(employee.toLocaleString());
		$("annual_company_match").innerHTML = '$'.concat(tribune.toLocaleString());
	
	} else if (percent > 4){
		employee = (salary * (percent / 100)) 
		tribune = (salary * (2 / 100)) + ((salary * ((percent - 2)  / 100)) / 2 )
		contrib = tribune + employee
		$("label_annual_contrib").innerHTML = "Your contribution";
		$("label_annual_company_match").innerHTML = "Tribune's match";
		$("annual_contrib").innerHTML = '$'.concat(employee.toLocaleString()).concat(' each year');
		$("annual_company_match").innerHTML = '$'.concat(tribune.toLocaleString().concat(' each year'));
	}

	futureValues(contrib)
}

var happy401kforChart = {} //store values for each year that is calculated
var sad401kforChart = {}   //store values for each year that is calculated


function futureValues(contrib) {
	var salary = $("salary").value.replace("$","").replace(",","")
	var percent = $("percent").value.replace("%","")
	var rate = $("rate").value.replace("%","") / 100
    var years = Math.round($("years").value)
	var futureValue = 0;
	var no_match_futureValue = 0;

	var happy401k = {} //store values for each year that is calculated
	var sad401k = {}   //store values for each year that is calculated

	
	for (i = 0; i < years; i++){	
		contrib_no_match = (salary * (percent / 100))
		var no_match_futureValue = (no_match_futureValue + contrib_no_match) * (1 + rate);

		sad401k[i + 1] = parseInt(no_match_futureValue.toFixed(0))
		$("no_match").innerHTML = "$".concat(parseInt(sad401k[1]).toLocaleString())
		$("no_match_final").innerHTML = "$".concat(parseInt(sad401k[years]).toLocaleString())

		futureValue = (futureValue + contrib) * (1 + rate); 
		happy401k[i + 1] = parseInt(futureValue.toFixed(0))	//upload year, value into a dict


		$("with_match").innerHTML =  "$".concat(parseInt(happy401k[1]).toLocaleString()) //extract value of first year
		$("with_match_final").innerHTML = "$".concat(parseInt(happy401k[years]).toLocaleString()) //extract value of final year
		$("label_match_final").innerHTML = "&nbsp;".concat("Year ").concat(years)
		$("label_difference").innerHTML = "&nbsp".concat("Year ").concat(years).concat(" difference")

		$("difference").innerHTML = "$".concat(parseInt(happy401k[years] - sad401k[years]).toLocaleString())

		$("including_interest").innerHTML = "With rate of return";
		$("label_with_match").innerHTML = "With match";
		$("label_no_match").innerHTML = "No match";
		$("first_year").innerHTML = "&nbsp;Year 1";
		$("leftarrow").innerHTML = "&#x2198;"
		$("rightarrow").innerHTML = "&#x2199;"
	}
	chart(happy401k, sad401k)
}


//add the line chart
function chart(happy401k, sad401k){
	// console.log(happy401k)
	// console.log(sad401k)
	console.log({"series":[[Object.values(sad401k)]]});	
	// new Chartist.Line('#line-chart', data);
}




window.onload = function (){
    
    $("salary").focus();
    $("button").onclick = companyContrib;

    document.addEventListener('keydown', function (event) {
	if (event.keyCode === 13 && event.target.nodeName === 'INPUT') {
	    event.preventDefault();
	    companyContrib();
	  }
	});
}

</script>
<script src="https://cdn.jsdelivr.net/chartist.js/latest/chartist.min.js"></script>
<script src="https://unpkg.com/@popperjs/core@2/dist/umd/popper.min.js"></script>
<script src="https://unpkg.com/tippy.js@6/dist/tippy-bundle.umd.js"></script>

<script>
  tippy('#zero', {
    content: 'Fill out the fields to see how the company match boosts your projected amount for retirement.',
    placement: 'right',
    maxWidth: 150
  });
  tippy('#one', {
    content: 'The company match is determined by what percent you contribute from your salary.',
    placement: 'right',
    maxWidth: 150
  });

  tippy('#two', {
    content: 'As of now, the company matches contributions dollar-for-dollar up to 2%, and 50 cents on the dollar for contributions 3% to 6%.',
    placement: 'right',
    maxWidth: 150
  });

   tippy('#three', {
    content: 'The average rate of return for a 401k is between 5.5% and 8%.',
    placement: 'right',
    maxWidth: 150
  });

  tippy('#four', {
    content: 'The earlier you start investing, the more you will see your money grow.',
    placement: 'right',
    maxWidth: 150
  }); 

</script>

</html>
